---
output:
  pdf_document: default
  html_document: default
---
```{r}
df <- read.csv('../Data/df.csv')
```
```{r}
(df <- read.csv('../Data/summary.df.csv'))
```

```{r}
library(ggplot2)
ggplot(df[df$theta == 0, ], aes(x = n, y = cov, color = method)) +
  geom_hline(yintercept = .95, linetype = 'dashed', color = 'orange') + 
  geom_errorbar(aes(ymin=lower, ymax=upper), colour="black", width=0.1) +
  geom_line() +
  geom_point(size = 0.5) +
  facet_grid(method ~ target) +
  labs(title = 'Theta = 0', x = 'Time Series Length', y = 'Confidence Interval Mean Recovery Rate', color = 'Method') +
  theme(legend.position="none") +
  scale_x_continuous(trans='log2')
```
```{r}
library(ggplot2)
ggplot(df[df$Theta == 0.2, ], aes(x = Sample.Length, y = Coverage.Rate, color = Method)) +
  geom_hline(yintercept = .95, linetype = 'dashed', color = 'orange') + 
  geom_errorbar(aes(ymin=Lower.Bound, ymax=Upper.Bound), colour="black", width=0.1) +
  geom_line() +
  geom_point(size = 0.5) +
  facet_grid(Method ~ Target) +
  labs(title = 'Theta = 0.2', x = 'Time Series Length', y = 'Confidence Interval Mean Recovery Rate', color = 'Method') +
  theme(legend.position="none") +
  scale_x_continuous(trans='log2')
ggsave('../Manuscript/theta_0.2.pdf', height = 5)
```
```{r}
library(ggplot2)
ggplot(df[df$theta == 0.2, ], aes(x = n, y = cov, color = method)) +
  geom_hline(yintercept = .95, linetype = 'dashed', color = 'orange') + 
  geom_errorbar(aes(ymin=lower, ymax=upper), colour="black", width=0.1) +
  geom_line() +
  geom_point(size = 0.5) +
  facet_grid(method ~ target) +
  labs(title = 'Theta = 0.2', x = 'Time Series Length', y = 'Confidence Interval Mean Recovery Rate', color = 'Method') +
  theme(legend.position="none") +
  scale_x_continuous(trans='log2')
```

```{r}
library(ggplot2)
ggplot(df[df$theta == 0.4, ], aes(x = n, y = cov, color = method)) +
  geom_hline(yintercept = .95, linetype = 'dashed', color = 'orange') + 
  geom_errorbar(aes(ymin=lower, ymax=upper), colour="black", width=0.1) +
  geom_line() +
  geom_point(size = 0.5) +
  facet_grid(method ~ target) +
  labs(title = 'Theta = 0.4', x = 'Time Series Length', y = 'Confidence Interval Mean Recovery Rate', color = 'Method') +
  theme(legend.position="none") +
  scale_x_continuous(trans='log2')
```